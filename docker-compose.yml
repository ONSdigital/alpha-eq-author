author:
  build: .
  ports:
   - "8000:8000"
  volumes:
   - .:/opt/eq-author
  environment:
    - SURVEY_RUNNER_URL=http://localhost:8080/
    - SURVEY_REGISTRY_URL=http://survey-registry:8081/
    - DATABASE_URL=postgres://author:password@postgres:5432/author
  links:
    - postgres
    - survey-registry
postgres:
  image: postgres:9.3.10
  volumes:
    - ./create_database.sql:/docker-entrypoint-initdb.d/create_database.sql
survey-runner:
  build: ../eq-survey-runner/.
  ports:
    - "8080:8080"
  volumes:
    - ../eq-survey-runner:/opt/eq-survey-runner
    - ~/.aws:/root/.aws
  entrypoint:
    - /opt/eq-survey-runner/entrypoint.sh
  environment:
    - SURVEY_REGISTRY_URL=http://survey-registry:8081
    - MODE=dev
  links:
   - cassandra
   - survey-registry
cassandra:
  image: spotify/cassandra
survey-registry:
  build: ../eq-survey-registry/.
  ports:
   - "8081:8081"
  volumes:
   - ../eq-survey-registry:/opt/eq-survey-registry
  entrypoint:
    - /opt/eq-survey-registry/entrypoint.sh
  environment:
    - MODE=dev
  links:
   - couchdb
couchdb:
  image: klaemo/couchdb:1.6.1
